<div class="container mx-auto">
  <%= render 'layouts/navbar' %>
  <h1 class="mb-3 text-center fw-bold">抽獎列表</h1>
  <div>
    <%= form_tag(lottery_comments_path(username: @user.username), method: :get, class: 'form-inline') do %>
      <div class="form-group">
        <%= text_field_tag :phone_number, params[:phone_number], class: 'form-control', placeholder: '手機號碼(抽獎用)' %>
      </div>

      <div class="form-group">
        <%= text_field_tag :name, params[:name], class: 'form-control', placeholder: '姓名' %>
      </div>

      <div class="form-group">
        <%= datetime_field :datetime_filter, :start_at,
                           value: params[:datetime_filter]&.values_at(:start_at) || @default_time_interval[:start_at],
                           class: 'form-control', placeholder: '提单起始日期' %>
      </div>

      <div class="form-group">
        <%= datetime_field :datetime_filter, :end_at,
                           value: params[:datetime_filter]&.values_at(:end_at) || @default_time_interval[:end_at],
                           class: 'form-control' %>
      </div>

      <div class="form-group">
        <%= select_tag :win,
                        options_for_select([['是', true], ['否 ', false]], params[:win]),
                        class: 'form-control', prompt: '是否中獎' %>
      </div>

      <%= submit_tag '抽一個', class: 'btn btn-primary' %>
    <% end %>
  </div>

  <table class="table table-hover text-center">
    <thead>
      <tr>
        <th>手機</th>
        <th>姓名</th>
        <th>祝福留言</th>
        <th>操作</th>
      </tr>
    </thead>
    <tbody>
      <% if @winner && @messages && @comment_ids %>
        <tr>
          <td><%= @winner[0] %></td>
          <td><%= @winner[1] %></td>
          <td><%= @messages %></td>
          <td><%= link_to '領獎', update_winner_comments_path(username: @user.username, comment_ids: @comment_ids), method: 'post', data: { confirm: '確定領獎？'} %></td>
        </tr>
      <% end %>
    </tbody>
  </table>
</div>
